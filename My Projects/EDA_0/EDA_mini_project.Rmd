---
title: "EDA_Project_PDF"
output: pdf_document
date: "2025-10-23"
---


## Summary: 

From 1975 to 2019 the house prices have risen generally in the US (after adjusting for inflation). But the amount of growth varies a lot by regions and states. Areas that have a faster population growth or higher population density usually tend to have a stronger housing price increase.

Also, the West (like California and Washington) and the South (like Florida and Texas) have the strongest growth in house prices because a lot of people have moved there, which raised the demand for houses. Moreover, regions like the Midwest stayed steady with small changes, and the Northeast grew slowly. 

The period of time 2000-2010 broke the pattern temporarily due to the 2008 housing crash. During that time, house prices fell down everywhere, even in fast-growing states like California.  But in 2010-2019 the link between population and housing prices became strong again, especially in states with a booming population. 

The biggest change in real house prices happened in the District of Columbia, where prices rose by almost +296%, showing very strong growth over time. On the other hand, West Virginia saw the largest drop, with prices falling by about –32%. This shows how uneven housing trends can be across states.

Overall, when more people move to a certain state, housing demand goes up and prices rise. Population growth plays a big role in how much house prices change over time.



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(tidyr)
cb_palette <- c("#999999", "#E69F00", "#56B4E9", "#009E73",
               "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
```

```{r, echo=FALSE}
cpi <- read.csv("cpi.csv")
state_abbrevs <- read.table("state_abbrevs.txt", header = TRUE)
State_and_US_SA <- read_excel("State_and_US_SA.xls", skip = 5)

censuspop2000 <- read.table("censuspop2000.txt", header = TRUE)
censuspop2010 <- read.table("censuspop2010.txt", header = TRUE)
censuspop2019 <- read.table("censuspop2019.txt", header = TRUE)
```
```{r,echo=FALSE}
State_and_US_SA <- State_and_US_SA[1:(nrow(State_and_US_SA)-16),]
```
```{r, echo=FALSE}
State_and_US_SA <- State_and_US_SA |> separate(Month,into = c("Year","Month"), sep = 4, remove = TRUE)
State_and_US_SA <- State_and_US_SA |> mutate(AK = as.numeric(AK))
State_and_US_SA <- State_and_US_SA |>dplyr::select(-`United States seasonally adjusted`)
```
```{r,echo=FALSE}
State.df <- State_and_US_SA |>
  pivot_longer(cols = -c(Year, Month),names_to = "Code",values_to = "HPI")
```
```{r,echo=FALSE}
State.df <- left_join(State.df,state_abbrevs,by = "Code")
```

```{r,echo=FALSE,message=FALSE}
Annual_HPI <- State.df |> group_by(Year,State,Region) |> summarise(MeanHPI = mean(HPI))
```
```{r,echo=FALSE}
Annual_CPI <- cpi |> dplyr::filter(Year > 1974) |> group_by(Year) |> summarise(MeanCPI = mean(Value))
```
```{r,echo=FALSE}
base_cpi <- Annual_CPI %>% filter(Year == 2000) %>% pull(MeanCPI)
Annual_CPI <- Annual_CPI %>%
  mutate(CPI2000 = 100 * MeanCPI / base_cpi)
```
```{r,echo=FALSE}
Annual_HPI <- Annual_HPI |> mutate(Year = as.integer(Year))
```

```{r,echo=FALSE}

Real_HPI <- Annual_HPI |> left_join(Annual_CPI, by = "Year") |> mutate(RealHPI = MeanHPI / (CPI2000 / 100))

```
```{r,echo=FALSE,message=FALSE}
ggplot(Real_HPI, aes(x = Year,y =RealHPI, group = State)) +geom_line(alpha = 0.35) +
  facet_wrap(~ Region, ncol = 2,scales = "free_y") +
  labs(title = "Real House Price Index by Region (1975–2019)",x = "Year", y = "Real House Price Index")
```
## Real House Price Index Changes by Region:

- West: prices have risen the most and changed a lot over time.

- Northeast: prices went up steadily with some ups and downs.

- South: some states grew fast; others have barely changed.

- Midwest: prices stayed the most stable with small changes overall.

```{r, echo=FALSE, message=FALSE}
ggplot(Real_HPI, aes(Year, RealHPI, group = State)) +
  geom_line(alpha = 0.5, color = "steelblue") +
  facet_wrap(~State, ncol = 8, scales = "free_y") +
  labs(title = "Real House Price Index by State",
       x = "Year", y = "Real House Price Index")+theme(strip.text = element_text(size = 7),axis.text.x = element_text(size = 5,angle = 90),axis.text.y = element_text(size = 5))
```
```{r, echo=FALSE,message=FALSE}
state_change <- Real_HPI |>
  group_by(State,Region) |>
  summarise(HPI_1975 = RealHPI[Year == 1975],HPI_2019 = RealHPI[Year == 2019],pct_change_75_19 = 100*(HPI_2019 - HPI_1975) / HPI_1975,.groups = "drop")

max_state <- state_change |>
  filter(pct_change_75_19 == max(pct_change_75_19))

min_state <- state_change |>
  filter(pct_change_75_19 == min(pct_change_75_19))

#max_state   # biggest increase
#min_state   # biggest decrease
```
## Biggest increase and decrease by state:

- Biggest increase: District of Columbia (+296%)

- Biggest decrease: West Virginia (–32%)

## House Prices Over Time (1975–2019)

After adjusting for inflation, US house prices have risen overall between 1975 and 2019 but not evenly. Most states show the same pattern, which is steady growth, a big rise in the early 2000s, then a heavy drop during the 2008 housing crash and then recovery after 2012. Overall, real house prices in the U.S. have increased since 1975, but growth depends heavily on region, with the West and D.C. growing faster than other states. 


```{r, echo=FALSE, message=FALSE}
pop2019 <- censuspop2019 |> dplyr::filter(variable == "DENSITY") |> dplyr::select(State = NAME, Density2019 =value)
#head(pop2019)
```

```{r, echo=FALSE, message=FALSE}
merged <- state_change |> left_join(pop2019, by = "State")
```

```{r,echo=FALSE}
merged <- merged |>
  dplyr::select(State, Region, pct_change_75_19, Density2019)

```

```{r,echo=FALSE, message=FALSE}
ggplot(merged, aes(x = Density2019, y = pct_change_75_19, color = Region)) +
  geom_point(size = 3, alpha = 0.8) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_x_log10() + scale_color_manual(values = cb_palette) +
  labs(title = "Population Density (2019) vs Real House Price Change (1975–2019)",x = "Logged Population Density",y = "% Change in Real HPI (1975–2019)")

```

Removing Washington DC (an outlier) from South Region

```{r, echo=FALSE, message=FALSE}
newMerged <- merged |> dplyr::filter(State != "District of Columbia") 
```

```{r, echo=FALSE, message=FALSE}
ggplot(newMerged, aes(x = Density2019, y = pct_change_75_19, color = Region)) +
  geom_point(size = 3, alpha = 0.8) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_x_log10() + scale_color_manual(values = cb_palette)+
  labs(title = "Population Density (2019) vs Real House Price Change (1975–2019)",x = "Logged Population Density",y = "% Change in Real HPI (1975–2019)") 
```

## Explanation:

States with a higher population density in 2019 tend to have bigger real house price increases from 1975 to 2019.

Washington DC is a strong outliers because it is very dense.

Washington DC gives (+296%), so removing them gives a clearer picture.

After dropping D.C., the link between density and price growth is still positive but a little bit weaker.

- West: strongest relationship Dense states like California and Washington grew the most.

- Northeast: moderate link with steady growth.

- South: mixed results – some fast growth, like Florida and Texas, and the others look flat.

- Midwest: little or no relationship.

Overall, denser states tend to have higher long-term housing price growth. 




```{r, echo=FALSE, message=FALSE}
pop2000 <- censuspop2000 |> dplyr::select(State = NAME, Pop2000 = value) |> dplyr::filter(State != "Puerto Rico")
pop2010 <- censuspop2010|> dplyr::select(State = NAME, Pop2010 = value) |> dplyr::filter(State != "Puerto Rico")
pop2019 <- censuspop2019 |> dplyr::filter(variable == "POP") |> dplyr::select(State = NAME, Pop2019 = value) |>  filter(State != "Puerto Rico")

```

```{r, echo=FALSE, message=FALSE}
pop <- pop2000 |>left_join(pop2010, by = "State") |> left_join(pop2019, by = "State")
```

```{r, echo=FALSE, message=FALSE}
pop_diff <- pop |>
  mutate(diff_00_10 = (Pop2010 - Pop2000) / Pop2000,
    diff_10_19 = (Pop2019 - Pop2010) / Pop2010,
    diff_00_19 = (Pop2019 - Pop2000) / Pop2000)

```

```{r, echo=FALSE, message=FALSE}
HPI_00_10_19 <- Real_HPI |>
  filter(Year %in% c(2000, 2010, 2019)) |>
  group_by(State, Region) |>
  summarise(HPI2000 = RealHPI[Year == 2000]
            ,HPI2010 = RealHPI[Year == 2010]
            ,HPI2019 = RealHPI[Year == 2019],
            .groups = "drop")

```

```{r, echo=FALSE, message=FALSE}
HPI_00_10_19 <- HPI_00_10_19 |>
  mutate(HPI_change_00_10 = 100 * (HPI2010 - HPI2000) / HPI2000,
    HPI_change_10_19 = 100 * (HPI2019 - HPI2010) / HPI2010,
    HPI_change_00_19 = 100 * (HPI2019 - HPI2000) / HPI2000)
```

```{r, echo=FALSE, message=FALSE}
MM <- HPI_00_10_19 |> left_join(pop_diff, by = "State") |> dplyr::filter(State != "District of Columbia") |> dplyr::filter(State != "Massachusetts")
```

```{r, warning = FALSE, echo=FALSE, message=FALSE}

ggplot(MM, aes(x = diff_00_10, y = HPI_change_00_10, color = Region)) +
  geom_point(size = 3, alpha = 0.8) +
  geom_smooth(method = "lm", se = FALSE) + scale_color_manual(values = cb_palette)+
  labs(title = "population vs. Real House Price Change (2000–2010)",
       x = "% Population Change", y = "% Real HPI Change")

```

## The Relationship between Population and Real House Price Change in 2000-2010, 

  - There is no clear positive relationship between population growth and house price change.

- West (the green line) 

  - The line slopes downwards, which means states with higher populations, like California and Nevada, showed a bigger price drop during the period 2000-2010, especially after 2008's housing crash.

- South (blue)

  - almost looks flat; the population grew, but the prices stayed the same or slightly dropped. 

- Northeast (Orange)

  - The line shows a negative relationship.Slower population growth areas often had smaller price declines or mild growth.

- Midwest (Grey)

  - showing a positive relationship, states with higher population growth tended to have higher house price increases.

```{r, echo=FALSE, message=FALSE}
ggplot(MM, aes(x = diff_10_19, y = HPI_change_10_19, color = Region)) +
  geom_point(size = 3, alpha = 0.8) +
  geom_smooth(method = "lm", se = FALSE) + scale_color_manual(values = cb_palette)+
  labs(title = "population vs. Real House Price Change (2010–2019)",
       x = "% Population Change", y = "% Real HPI Change")
```




## The Relationship between Population and Real House Price Change in 2010-2019:

Positive slopes across all regions, which means that states with faster population growth tend to have a bigger house price increase. During this period of time, population growth and house prices are closely connected. In the West and South, fast-growing populations made the prices go up. The Midwest stayed stable, while the Northeast grew slowly but steadily.

- West (the green line) 

  - The west shows the strongest positive relationship.States like California, Washington and Oregon grew rapidly in both people and housing prices.

- South (blue)

  - The south also shows a strong positive relationship.Fast-growing states like Florida and Texas saw larger price gains. 

- Northeast (Orange)

  - shows a small positive slope, which means its housing market has risen moderately even where population growth was small.

- Midwest (Grey)

  - A weaker positive relationship compared to other regions.Population and housing prices barely moved, showing a more stable but slower market.


```{r, echo=FALSE, message=FALSE}
ggplot(MM, aes(x = diff_00_19, y = HPI_change_00_19, color = Region)) +
  geom_point(size = 3, alpha = 0.8) +
  geom_smooth(method = "lm", se = FALSE) + scale_color_manual(values = cb_palette)+labs(title = "population vs. Real House Price Change (2000–2019)",x = "% Population Change", y = "% Real HPI Change")
```
## The Relationship between Population and Real House Price Change in 2000-2019

Between 2000 and 2019, states with higher growing populations, especially in regions like the South and Midwest, saw stronger housing growth. The West stayed expensive overall, and the Northeast had slower change.

- West (the green line) 

  - The line is almost flat, which means that prices in this period of time were high in most western states no matter how much the population has changed.

- South (blue) and Midwest (grey)

  - states that grew faster in population saw bigger increases in house prices.

- Northeast (Orange)

  - it shows a negative relationship; prices went up even when population growth was small. 
